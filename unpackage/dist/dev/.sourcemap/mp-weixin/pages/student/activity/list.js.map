{"version":3,"file":"list.js","sources":["pages/student/activity/list.vue","../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvc3R1ZGVudC9hY3Rpdml0eS9saXN0LnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"activity-list-container\">\n    <!-- 搜索框 -->\n    <view class=\"search-container\">\n      <view class=\"search-box\">\n        <uni-icons type=\"search\" size=\"18\" color=\"#999\"></uni-icons>\n        <input type=\"text\" v-model=\"searchParams.keyword\" placeholder=\"搜索活动\" placeholder-class=\"placeholder\" @input=\"onSearch\" />\n      </view>\n    </view>\n\n    <!-- 筛选条件 -->\n    <view class=\"filter-container\">\n      <view class=\"filter-group\">\n        <text class=\"filter-label\">类型：</text>\n        <view class=\"filter-options\">\n          <view \n            :class=\"['filter-option', { active: searchParams.type === '' }]\"\n            @tap=\"onTypeChange('')\"\n          >\n            全部\n          </view>\n          <view \n            v-for=\"type in activityTypes\" \n            :key=\"type.value\"\n            :class=\"['filter-option', { active: searchParams.type === type.value }]\"\n            @tap=\"onTypeChange(type.value)\"\n          >\n            {{ type.label }}\n          </view>\n        </view>\n      </view>\n    </view>\n\n    <!-- 骨架屏 -->\n    <skeleton \n      v-if=\"isLoading\" \n      :is-loading=\"true\" \n      :show-list=\"true\" \n      :list-count=\"10\"\n    ></skeleton>\n\n    <!-- 活动列表 -->\n    <view v-else-if=\"activityList.length > 0\" class=\"activity-list\">\n      <view \n        v-for=\"activity in activityList\" \n        :key=\"activity.id\"\n        class=\"activity-item\"\n        @tap=\"goToActivityDetail(activity.id)\"\n      >\n        <lazy-image :src=\"activity.cover || '/static/student/default-activity.png'\" mode=\"aspectFill\"></lazy-image>\n        <view class=\"activity-info\">\n          <text class=\"activity-title\">{{ activity.title }}</text>\n          <view class=\"activity-meta\">\n            <uni-icons type=\"time\" size=\"16\" color=\"#999\"></uni-icons>\n            <text class=\"activity-time\">{{ formatDate(activity.startTime) }}</text>\n          </view>\n          <view class=\"activity-meta\">\n            <uni-icons type=\"location\" size=\"16\" color=\"#999\"></uni-icons>\n            <text class=\"activity-location\">{{ activity.location || '地点待定' }}</text>\n          </view>\n          <view class=\"activity-stats\">\n            <text class=\"stat-item\">{{ activity.joinCount }}人已报名</text>\n            <text class=\"stat-item\">{{ activity.clubName || '未知社团' }}</text>\n          </view>\n        </view>\n      </view>\n    </view>\n\n    <!-- 空状态 -->\n    <view v-else class=\"empty\">\n      <uni-icons type=\"info\" size=\"60\" color=\"#ccc\"></uni-icons>\n      <text>暂无活动数据</text>\n    </view>\n\n    <!-- 分页 -->\n    <uni-pagination \n      v-if=\"total > 0\" \n      :current=\"searchParams.page\" \n      :page-size=\"searchParams.size\" \n      :total=\"total\" \n      @change=\"onPageChange\"\n      mode=\"number\"\n      prev-text=\"上一页\"\n      next-text=\"下一页\"\n    ></uni-pagination>\n\n    <!-- 底部导航栏 -->\n    <!-- <student-tabbar :activeIndex=\"2\" @change=\"onTabChange\"></student-tabbar> -->\n  </view>\n</template>\n\n<script>\nimport { activityApi } from '../../../api/student/activity.js';\nimport lazyImage from '../../../components/lazy-image/lazy-image.vue';\nimport studentTabbar from '../../../components/student-tabbar/student-tabbar.vue';\nimport skeleton from '../../../components/skeleton/skeleton.vue';\n\nexport default {\n  components: {\n    lazyImage,\n    studentTabbar,\n    skeleton\n  },\n  data() {\n    return {\n      searchParams: {\n        page: 1,\n        size: 10,\n        type: '',\n        keyword: ''\n      },\n      activityList: [],\n      total: 0,\n      isLoading: true,\n      activityTypes: [\n        { label: '学术讲座', value: 'lecture' },\n        { label: '文化活动', value: 'culture' },\n        { label: '体育赛事', value: 'sports' },\n        { label: '公益活动', value: 'public' },\n        { label: '其他', value: 'other' }\n      ],\n      searchTimer: null\n    };\n  },\n  onLoad() {\n    this.loadActivityList();\n  },\n  methods: {\n    // 加载活动列表\n    async loadActivityList() {\n      this.isLoading = true;\n      try {\n        const res = await activityApi.getActivityList(this.searchParams);\n        if (res.code === 200) {\n          this.activityList = res.data.list || [];\n          this.total = res.data.total || 0;\n        } else {\n          uni.showToast({ title: res.message || '加载失败', icon: 'none' });\n        }\n      } catch (error) {\n        console.error('加载活动列表失败:', error);\n        uni.showToast({ title: '网络错误', icon: 'none' });\n      } finally {\n        this.isLoading = false;\n      }\n    },\n    \n    // 搜索\n    onSearch() {\n      // 添加防抖处理\n      clearTimeout(this.searchTimer);\n      this.searchTimer = setTimeout(() => {\n        this.searchParams.page = 1;\n        this.loadActivityList();\n      }, 300);\n    },\n    \n    // 类型筛选\n    onTypeChange(type) {\n      this.searchParams.type = type;\n      this.searchParams.page = 1;\n      this.loadActivityList();\n    },\n    \n    // 分页切换\n    onPageChange(page) {\n      console.log('分页切换:', page, typeof page);\n      // 确保 page 是数字类型\n      const pageNum = parseInt(page);\n      if (!isNaN(pageNum) && pageNum > 0) {\n        this.searchParams.page = pageNum;\n        this.loadActivityList();\n      }\n    },\n    \n    // 跳转到活动详情\n    goToActivityDetail(activityId) {\n      uni.navigateTo({\n        url: `/pages/student/activity/detail?id=${activityId}`\n      });\n    },\n    \n    // 格式化日期\n    formatDate(dateStr) {\n      if (!dateStr) return '';\n      const date = new Date(dateStr);\n      return `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}-${date.getDate().toString().padStart(2, '0')} ${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;\n    },\n\n    // 底部导航栏变化\n    onTabChange(index) {\n      console.log('当前选中的tab:', index);\n    }\n  }\n};\n</script>\n\n<style scoped>\n.activity-list-container {\n  padding-bottom: 120rpx; /* 为底部导航栏留出空间 */\n}\n\n/* 搜索框 */\n.search-container {\n  padding: 20rpx;\n  background-color: #fff;\n}\n\n.search-box {\n  display: flex;\n  align-items: center;\n  padding: 12rpx 20rpx;\n  background-color: #f5f5f5;\n  border-radius: 40rpx;\n}\n\n.search-box input {\n  margin-left: 10rpx;\n  font-size: 28rpx;\n  color: #333;\n}\n\n.placeholder {\n  color: #999;\n}\n\n/* 筛选条件 */\n.filter-container {\n  padding: 20rpx;\n  background-color: #fff;\n  border-bottom: 1rpx solid #eee;\n}\n\n.filter-group {\n  margin-bottom: 20rpx;\n}\n\n.filter-label {\n  font-size: 28rpx;\n  color: #666;\n}\n\n.filter-options {\n  display: flex;\n  flex-wrap: wrap;\n  margin-top: 10rpx;\n}\n\n.filter-option {\n  padding: 8rpx 20rpx;\n  margin-right: 20rpx;\n  margin-bottom: 10rpx;\n  font-size: 26rpx;\n  color: #666;\n  background-color: #f5f5f5;\n  border-radius: 20rpx;\n}\n\n.filter-option.active {\n  color: #fff;\n  background-color: #007aff;\n}\n\n/* 活动列表 */\n.activity-list {\n  background-color: #fff;\n}\n\n.activity-item {\n  display: flex;\n  padding: 20rpx;\n  margin-bottom: 20rpx;\n  background-color: #fff;\n  border-radius: 10rpx;\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.1);\n  /* 增加点击区域 */\n  border: 2rpx solid transparent;\n}\n\n.activity-item:active {\n  border-color: #007aff;\n  background-color: rgba(0, 122, 255, 0.05);\n}\n\n.activity-item image {\n  width: 200rpx;\n  height: 140rpx;\n  border-radius: 10rpx;\n}\n\n.activity-info {\n  flex: 1;\n  margin-left: 20rpx;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n}\n\n.activity-title {\n  font-size: 30rpx;\n  color: #333;\n  line-height: 40rpx;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n}\n\n.activity-meta {\n  display: flex;\n  align-items: center;\n  margin-top: 10rpx;\n}\n\n.activity-time, .activity-location {\n  margin-left: 5rpx;\n  font-size: 24rpx;\n  color: #999;\n}\n\n.activity-stats {\n  display: flex;\n  justify-content: space-between;\n  margin-top: 10rpx;\n}\n\n.stat-item {\n  font-size: 24rpx;\n  color: #999;\n}\n\n/* 空状态 */\n.empty {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 100rpx 0;\n}\n\n.empty text {\n  margin-top: 20rpx;\n  font-size: 28rpx;\n  color: #999;\n}\n\n/* 分页 */\nuni-pagination {\n  margin: 40rpx 0;\n}\n</style>\n","import MiniProgramPage from 'C:/Users/Fooler/Desktop/MultiCommunityApplication/sss/community-frontend-wxprogram/pages/student/activity/list.vue'\nwx.createPage(MiniProgramPage)"],"names":["activityApi","uni"],"mappings":"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"}