{"version":3,"file":"index.js","sources":["pages/student/index.vue","../../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvc3R1ZGVudC9pbmRleC52dWU"],"sourcesContent":["<template>\n  <view class=\"student-home-container\">\n    <!-- 顶部搜索栏 -->\n    <view class=\"top-search-bar\">\n      <image src=\"/static/student/logo.png\" class=\"logo\"></image>\n      <view class=\"search-box\">\n        <uni-icons type=\"search\" size=\"18\" color=\"#999\"></uni-icons>\n        <text class=\"search-placeholder\" @tap=\"goToSearch\">搜索社团、活动</text>\n      </view>\n      <uni-icons type=\"person\" size=\"24\" color=\"#666\" @tap=\"goToPersonal\"></uni-icons>\n    </view>\n\n    <!-- 轮播图 -->\n    <view class=\"banner-container\">\n      <uni-swiper\n        :indicator-dots=\"true\"\n        :autoplay=\"true\"\n        :interval=\"3000\"\n        :duration=\"500\"\n        :circular=\"true\"\n        indicator-color=\"rgba(255, 255, 255, 0.3)\"\n        indicator-active-color=\"#fff\"\n        style=\"height: 300rpx;\"\n      >\n        <uni-swiper-item v-for=\"(item, index) in bannerList\" :key=\"index\">\n          <image :src=\"item.image\" mode=\"aspectFill\" class=\"banner-image\"></image>\n        </uni-swiper-item>\n      </uni-swiper>\n    </view>\n\n    <!-- 热门社团 -->\n    <view class=\"section\">\n      <view class=\"section-header\">\n        <text class=\"section-title\">热门社团</text>\n        <text class=\"more-btn\" @tap=\"goToClubList\">查看更多</text>\n      </view>\n      <view v-if=\"popularClubs.length > 0\" class=\"club-list\">\n        <view class=\"club-item\" v-for=\"club in popularClubs\" :key=\"club.id\" @tap=\"goToClubDetail(club.id)\">\n          <lazy-image :src=\"club.logo || '/static/student/default-club.png'\" mode=\"aspectFill\" class=\"club-logo\"></lazy-image>\n          <view class=\"club-info\">\n            <text class=\"club-name\">{{ club.name }}</text>\n            <text class=\"club-desc\">{{ club.description || '暂无简介' }}</text>\n            <view class=\"club-stats\">\n              <text>{{ club.memberCount }}人</text>\n              <text>{{ formatDate(club.createTime, true) }}</text>\n            </view>\n          </view>\n        </view>\n      </view>\n      <skeleton v-else :is-loading=\"true\" :show-list=\"true\" :list-count=\"3\"></skeleton>\n    </view>\n\n    <!-- 最新活动 -->\n    <view class=\"section\">\n      <view class=\"section-header\">\n        <text class=\"section-title\">最新活动</text>\n        <text class=\"more-btn\" @tap=\"goToActivityList\">查看更多</text>\n      </view>\n      <view v-if=\"latestActivities.length > 0\" class=\"activity-list\">\n        <view class=\"activity-item\" v-for=\"activity in latestActivities\" :key=\"activity.id\" @tap=\"goToActivityDetail(activity.id)\">\n          <lazy-image :src=\"activity.cover || '/static/student/default-club.png'\" mode=\"aspectFill\" class=\"activity-cover\"></lazy-image>\n          <view class=\"activity-info\">\n            <text class=\"activity-title\">{{ activity.title }}</text>\n            <view class=\"activity-meta\">\n              <text>{{ activity.clubName }}</text>\n              <text>{{ formatDate(activity.startTime) }}</text>\n            </view>\n          </view>\n        </view>\n      </view>\n      <skeleton v-else :is-loading=\"true\" :show-list=\"true\" :list-count=\"3\"></skeleton>\n    </view>\n\n    <!-- 底部导航栏 -->\n    <!-- <student-tabbar :activeIndex=\"0\" @change=\"onTabChange\"></student-tabbar> -->\n  </view>\n</template>\n\n<script>\nimport { homeApi } from '../../api/student/home.js';\nimport { activityApi } from '../../api/student/activity.js';\nimport { clubApi } from '../../api/student/club.js';\nimport lazyImage from '../../components/lazy-image/lazy-image.vue';\nimport studentTabbar from '../../components/student-tabbar/student-tabbar.vue';\nimport skeleton from '../../components/skeleton/skeleton.vue';\n\nexport default {\n  components: {\n    lazyImage,\n    studentTabbar,\n    skeleton\n  },\n  data() {\n    return {\n      // 设置默认轮播图数据，使用static/student文件夹里的图片\n      bannerList: [\n        { image: '/static/student/118675776_p0.jpg' },\n        { image: '/static/student/118675776_p0(1).png' },\n        { image: '/static/student/logo.png' }\n      ],\n      popularClubs: [],\n      latestActivities: [],\n      loading: false\n    };\n  },\n  onLoad() {\n    // 加载首页信息\n    this.loadHomeInfo();\n  },\n  methods: {\n    // 加载首页信息\n    async loadHomeInfo() {\n      this.loading = true;\n      // 不显示加载动画，避免影响用户体验\n      try {\n        const homeRes = await homeApi.getHomeInfo();\n        console.log('首页API响应:', homeRes);\n        if (homeRes.code === 200) {\n          // 处理后端返回的数据结构\n        // 检查是否有轮播图数据，如果没有则使用默认图片\n        if (homeRes.data && homeRes.data.banners && homeRes.data.banners.length > 0) {\n          this.bannerList = homeRes.data.banners;\n        } else {\n          console.log('首页API未返回轮播图数据，使用默认图片');\n          // 使用static/student文件夹里的图片作为默认轮播图\n          this.bannerList = [\n            { image: '/static/student/118675776_p0.jpg' },\n            { image: '/static/student/118675776_p0(1).png' },\n            { image: '/static/student/logo.png' }\n          ];\n        }\n        } else {\n          console.error('首页API请求失败:', homeRes);\n          // 请求失败时也使用默认图片\n          this.bannerList = [\n            { image: '/static/student/logo.png' }\n          ];\n        }\n      } catch (error) {\n        console.error('加载首页信息失败:', error);\n        // 捕获到错误时使用默认图片\n        this.bannerList = [\n          { image: '/static/student/logo.png' }\n        ];\n      }\n\n      // 使用社团列表API获取热门社团，替代首页API中的社团数据\n      try {\n        const clubRes = await clubApi.getClubList({ sort: 'hot', page: 1, limit: 5 });\n        console.log('热门社团API响应:', clubRes);\n        if (clubRes.code === 200) {\n          this.popularClubs = clubRes.data.list || [];\n        } else {\n          console.error('热门社团API请求失败:', clubRes);\n        }\n      } catch (error) {\n        console.error('加载热门社团失败:', error);\n      }\n\n      // 使用活动列表API获取最新活动，替代首页API中的活动数据\n      try {\n        const activityRes = await activityApi.getActivityList({ page: 1, size: 3 });\n        console.log('活动列表API响应:', activityRes);\n        if (activityRes.code === 200) {\n          this.latestActivities = activityRes.data.list || [];\n        } else {\n          console.error('活动列表API请求失败:', activityRes);\n        }\n      } catch (error) {\n        console.error('加载最新活动失败:', error);\n      } finally {\n        this.loading = false;\n      }\n    },\n\n    // 格式化日期\n    formatDate(dateStr, isDateOnly = false) {\n      if (!dateStr) return '';\n      const date = new Date(dateStr);\n      if (isDateOnly) {\n        // 只显示月日\n        return `${(date.getMonth() + 1).toString().padStart(2, '0')}-${date.getDate().toString().padStart(2, '0')}`;\n      }\n      return `${date.getMonth() + 1}月${date.getDate()}日`;\n    },\n\n    // 跳转到搜索页面\n    goToSearch() {\n      uni.navigateTo({\n        url: '/pages/student/search'\n      });\n    },\n\n    // 跳转到个人中心\n    goToPersonal() {\n      uni.switchTab({\n        url: '/pages/student/personal/index'\n      });\n    },\n\n    // 跳转到社团列表\n    goToClubList() {\n      uni.switchTab({\n        url: '/pages/student/club/list'\n      });\n    },\n\n    // 跳转到社团详情\n    goToClubDetail(id) {\n      uni.navigateTo({\n        url: `/pages/student/club/detail?id=${id}`\n      });\n    },\n\n    // 跳转到活动列表\n    goToActivityList() {\n      uni.switchTab({\n        url: '/pages/student/activity/list'\n      });\n    },\n\n    // 跳转到活动详情\n    goToActivityDetail(id) {\n      uni.navigateTo({\n        url: `/pages/student/activity/detail?id=${id}`\n      });\n    },\n\n    // 底部导航栏变化\n    onTabChange(index) {\n      console.log('当前选中的tab:', index);\n    }\n  }\n};\n</script>\n\n<style scoped>\n.student-home-container {\n  min-height: 100vh;\n  background-color: #f5f5f5;\n  padding-bottom: 100rpx; /* 为底部导航栏留出空间 */\n}\n\n/* 顶部搜索栏 */\n.top-search-bar {\n  display: flex;\n  align-items: center;\n  padding: 20rpx;\n  background-color: #fff;\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.1);\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  z-index: 100;\n}\n\n.logo {\n  width: 60rpx;\n  height: 60rpx;\n  margin-right: 20rpx;\n}\n\n.search-box {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  padding: 15rpx 20rpx;\n  background-color: #f5f5f5;\n  border-radius: 30rpx;\n  /* 优化点击区域 */\n  min-height: 60rpx;\n}\n\n.search-placeholder {\n  margin-left: 10rpx;\n  font-size: 26rpx;\n  color: #999;\n}\n\n/* 轮播图 */\n.banner-container {\n    width: 100%;\n    margin-top: 100rpx;\n    margin-bottom: 20rpx;\n    height: 300rpx;\n    overflow: hidden;\n  }\n\n  .banner-image {\n    width: 100%;\n    height: 300rpx;\n  }\n\n/* 通用区块样式 */\n.section {\n  margin-top: 20rpx;\n  padding: 0 20rpx;\n  background-color: #fff;\n}\n\n.section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 20rpx 0;\n}\n\n.section-title {\n  font-size: 30rpx;\n  font-weight: bold;\n  color: #333;\n}\n\n.more-btn {\n  font-size: 24rpx;\n  color: #999;\n}\n\n/* 社团列表 */\n.club-list {\n  display: flex;\n  overflow-x: auto;\n  padding-bottom: 20rpx;\n  /* 优化滚动体验 */\n  -webkit-overflow-scrolling: touch;\n}\n\n.club-item {\n  width: 220rpx;\n  margin-right: 20rpx;\n  /* 增加点击区域 */\n  padding: 5rpx;\n  border-radius: 10rpx;\n}\n\n.club-item:active {\n  background-color: rgba(0, 0, 0, 0.05);\n}\n\n.club-logo {\n  width: 220rpx;\n  height: 220rpx;\n  border-radius: 10rpx;\n  margin-bottom: 10rpx;\n}\n\n.club-name {\n  display: block;\n  font-size: 26rpx;\n  font-weight: bold;\n  color: #333;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.club-desc {\n  display: block;\n  font-size: 22rpx;\n  color: #999;\n  margin-top: 5rpx;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n  height: 50rpx;\n  line-height: 25rpx;\n}\n\n.club-stats {\n  display: flex;\n  justify-content: space-between;\n  margin-top: 10rpx;\n  font-size: 20rpx;\n  color: #999;\n}\n\n/* 活动列表 */\n.activity-list {\n  display: flex;\n  flex-direction: column;\n}\n\n.activity-item {\n  display: flex;\n  margin-bottom: 20rpx;\n  /* 增加点击区域 */\n  padding: 5rpx;\n  border-radius: 10rpx;\n}\n\n.activity-item:active {\n  background-color: rgba(0, 0, 0, 0.05);\n}\n\n.activity-cover {\n  width: 180rpx;\n  height: 120rpx;\n  border-radius: 10rpx;\n}\n\n.activity-info {\n  flex: 1;\n  margin-left: 20rpx;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n}\n\n.activity-title {\n  font-size: 28rpx;\n  color: #333;\n  font-weight: bold;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n  line-height: 40rpx;\n}\n\n.activity-meta {\n  display: flex;\n  justify-content: space-between;\n  font-size: 22rpx;\n  color: #999;\n}\n</style>\n","import MiniProgramPage from 'C:/Users/Fooler/Desktop/MultiCommunityApplication/sss/community-frontend-wxprogram/pages/student/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["homeApi","uni","clubApi","activityApi"],"mappings":"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"}